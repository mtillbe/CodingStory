<!doctype html>
<html dir="ltr" lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Responsive Carousel</title>
        <link rel="stylesheet" href="main.css">
        <link rel="stylesheet" href="carousel.css">
    </head>
    <body>
        <div class="carousel">
            <ul class="carousel__slides">
                <li><img src="ice2.jpg"></li>
                <li><img src="me_1.jpg"></li>
                <li><img src="images/C.jpg"></li>
                <li><img src="images/D.jpg"></li>
            </ul>
        </div>
        
        <script src="ender.js"></script>
        <script>
            var container = $('.carousel');
            var carousel = $('.carousel__slides');
            var container_dimensions = container.dim(); // e.g. { height: 610, width: 960 }
            var slide = carousel.find('img').eq(0);
            var slide_dimensions = slide.dim(); // e.g. { height: 605, width: 960 }
            var previous_width = slide_dimensions.width; 
            var current_position = current_slide = 0;
            var slides, total_container_width, last_frame_position;

            function insert_pagination(){
                container.append('<span class="carousel__pagination carousel__pagination--prev"></span><span class="carousel__pagination carousel__pagination--next"></span>');

               
            }

            insert_pagination();

            carousel.addClass('carousel__slides--js');

            container.height(slide_dimensions.height);

            carousel.append(carousel.find('li').eq(0).clone());

            slides = carousel.find('li');

            total_container_width = slide_dimensions.width * slides.length;

            last_frame_position = -(total_container_width - slide_dimensions.width);

            slides.each(function (item, index) {
                if (index > 0) {
                    $(item).css('left', slide_dimensions.width * index);
                }
            });

    
            function check_movement (show_previous) {
                
                if (show_previous && current_position === slide_dimensions.width) {
                    return false;
                } 

                
                if (current_position < last_frame_position) {
                    return false;
                }

                return true;
            }

            
            function reposition (show_previous) {
                if (show_previous) {
                    carousel.css('left', last_frame_position);
                    current_position = last_frame_position;
                    
                    current_slide = slides.length-1;
                } else {
                    carousel.css('left', 0);
                    current_position = 0;

                    current_slide = 0;
                }

               
                move(null, show_previous);
            }

            
            function move (e, show_previous) {
                container.off('click');

                var direction = (show_previous) ? current_position += slide_dimensions.width : current_position -= slide_dimensions.width;

                previous_width = slide_dimensions.width;

                if (show_previous) {
                    current_slide--;
                } else {
                    current_slide++;
                }

                if (check_movement(show_previous)) {
                    carousel.animate({ 
                        duration: 500,
                        left: current_position,
                        complete: setup_interaction_listeners
                    });
                } else {
                    reposition(show_previous);
                }
            }

            
            function setup_interaction_listeners(){
                container.on('click', '.carousel__pagination--prev', move, true);
                container.on('click', '.carousel__pagination--next', move);
            }

            setup_interaction_listeners();

            $(window).on('resize orientationchange', function(){
                
                slide_dimensions = slide.dim();

                current_position = -(current_slide * slide_dimensions.width);

                slides.each(function (item, index) {
                    if (index > 0) {
                        $(item).css('left', slide_dimensions.width * index);
                    }
                });

                carousel.css('left', current_position);

                total_container_width = slide_dimensions.width * slides.length;

                last_frame_position = -(total_container_width - slide_dimensions.width);

               
                container.height(slide_dimensions.height);
            });

        </script>
    </body>
</html>
